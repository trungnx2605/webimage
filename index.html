<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  <!-- SEO Meta Tags -->
  <title>Free Background Generator - Add Beautiful Gradients & Images to Photos | AddBackground</title>
  <meta name="description" content="Create stunning images with beautiful gradient and photo backgrounds. Free online tool to add backgrounds, adjust padding, rounded corners, and download high-quality images instantly.">
  <meta name="keywords" content="background generator, gradient background, image background, photo editor, free online tool, add background to image, gradient maker, image editor">
  <meta name="author" content="Trung Nguyễn">
  <meta name="robots" content="index, follow">
  <meta name="language" content="EN">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://addbackground.app">
  <meta property="og:title" content="Free Background Generator - Add Beautiful Gradients & Images to Photos">
  <meta property="og:description" content="Create stunning images with beautiful gradient and photo backgrounds. Free online tool to add backgrounds, adjust padding, rounded corners, and download high-quality images instantly.">
  <meta property="og:image" content="https://cdn.addbackground.app/image/addbackground.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="AddBackground - Free Background Generator Tool">
  <meta property="og:site_name" content="AddBackground">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://addbackground.app">
  <meta property="twitter:title" content="Free Background Generator - Add Beautiful Gradients & Images to Photos">
  <meta property="twitter:description" content="Create stunning images with beautiful gradient and photo backgrounds. Free online tool to add backgrounds, adjust padding, rounded corners, and download high-quality images instantly.">
  <meta property="twitter:image" content="https://cdn.addbackground.app/image/addbackground.png">
  <meta property="twitter:image:alt" content="AddBackground - Free Background Generator Tool">
  <meta name="twitter:creator" content="@trungtalks">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="https://img.icons8.com/plasticine/100/image.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://img.icons8.com/plasticine/100/image.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://img.icons8.com/plasticine/100/image.png">
  <link rel="shortcut icon" href="https://img.icons8.com/plasticine/100/image.png">
  
  <!-- Additional SEO -->
  <meta name="theme-color" content="#4CAF50">
  <meta name="msapplication-TileColor" content="#4CAF50">
  <meta name="msapplication-TileImage" content="https://img.icons8.com/plasticine/100/image.png">
  <link rel="canonical" href="https://addbackground.app">
  
  <!-- Structured Data for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "AddBackground - Background Generator",
    "url": "https://addbackground.app",
    "description": "Free online tool to add beautiful gradient and photo backgrounds to images with customizable padding, rounded corners, and shadows.",
    "applicationCategory": "DesignApplication",
    "operatingSystem": "Web Browser",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "creator": {
      "@type": "Person",
      "name": "Trung Nguyễn",
      "url": "https://www.facebook.com/trungnx26/"
    },
    "screenshot": "https://cdn.addbackground.app/image/addbackground.png",
    "featureList": [
      "Add gradient backgrounds to images",
      "Add photo backgrounds to images", 
      "Adjust image padding and spacing",
      "Customize rounded corners",
      "Add drop shadows",
      "Multiple aspect ratios support",
      "Add text signatures",
      "High-quality image downloads",
      "Drag and drop image upload"
    ]
  }
  </script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background: #f0f0f0;
    }

    .container {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .canvas-frame {
      transition: all 0.8s ease;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      border-radius: 12px;
      overflow: hidden;
    }

    .canvas-frame.drag-over {
      box-shadow: 0 20px 40px rgba(74, 144, 226, 0.5);
      transform: scale(1.02);
    }

    .image-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      transition: padding 0.3s ease;
    }

    .uploaded-image {
      max-width: 95%;
      max-height: 95%;
      width: auto;
      height: auto;
      object-fit: contain;
      transition: all 0.3s ease;
    }

    .theme-selector {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      gap: 16px;
      background: rgba(255, 255, 255, 0.9);
      padding: 16px;
      border-radius: 16px;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      align-items: center;
    }

    .theme-column {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .theme {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid #fff;
      box-shadow: 0 0 4px rgba(0,0,0,0.1);
      transition: transform 0.2s ease;
    }

    .theme:hover {
      transform: scale(1.1);
    }

    .image-theme {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid #fff;
      box-shadow: 0 0 4px rgba(0,0,0,0.1);
      transition: transform 0.2s ease;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      /* Optimize image loading for thumbnails */
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
      background-attachment: scroll; /* Prevent repainting issues */
    }

    .image-theme:hover {
      transform: scale(1.1);
    }

    .upload-box {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.95);
      padding: 32px 40px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      text-align: center;
      transition: all 0.3s ease;
      border: 2px dashed rgba(74, 144, 226, 0.3);
      max-width: 300px;
    }

    .upload-box:hover {
      transform: translate(-50%, -50%) scale(1.05);
      border-color: rgba(74, 144, 226, 0.6);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
    }

    .upload-box.drag-over {
      transform: translate(-50%, -50%) scale(1.1);
      border-color: rgba(74, 144, 226, 0.8);
      background: rgba(74, 144, 226, 0.1);
      box-shadow: 0 30px 60px rgba(74, 144, 226, 0.3);
    }

    .upload-box h3 {
      margin: 0 0 12px 0;
      color: #333;
      font-size: 20px;
      font-weight: 600;
    }

    .upload-box p {
      margin: 0 0 20px 0;
      color: #666;
      font-size: 14px;
      line-height: 1.4;
    }

    .upload-btn {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      font-size: 16px;
      transition: all 0.2s ease;
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
    }

    .upload-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
    }

    .control-panel {
      position: absolute;
      top: 50%;
      left: 20px;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.9);
      padding: 18px;
      border-radius: 16px;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 200px;
    }

    .control-panel label {
      font-size: 14px;
      font-weight: bold;
      color: #333;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .control-panel input[type="range"] {
      width: 100%;
    }

    .value-display {
      font-size: 12px;
      background: #f0f0f0;
      padding: 2px 6px;
      border-radius: 4px;
      color: #666;
      min-width: 35px;
      text-align: center;
    }

    .download-box {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.9);
      padding: 12px 16px;
      border-radius: 12px;
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    }

    .download-btn {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .download-btn:hover {
      background: #45a049;
      transform: translateY(-1px);
    }

    .download-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .ratio-selector {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.9);
      padding: 12px 16px;
      border-radius: 12px;
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .ratio-btn {
      padding: 8px 12px;
      background: rgba(255, 255, 255, 0.7);
      border: 2px solid transparent;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      font-weight: bold;
      color: #555;
      transition: all 0.2s ease;
      min-width: 50px;
      text-align: center;
    }

    .ratio-btn:hover {
      background: rgba(255, 255, 255, 1);
      transform: translateY(-1px);
    }

    .ratio-btn.active {
      background: #4CAF50;
      color: white;
      border-color: #45a049;
    }

    /* Gradient Themes - Row 1 */
    .cool   { background: linear-gradient(135deg, #a1c4fd, #c2e9fb); }
    .beach  { background: linear-gradient(135deg, #00c9ff, #92fe9d); }
    .violet { background: linear-gradient(135deg, #a18cd1, #fbc2eb); }
    .rose   { background: linear-gradient(135deg, #fbc2eb, #a6c1ee); }
    .sky    { background: linear-gradient(135deg, #89f7fe, #66a6ff); }
    .love   { background: linear-gradient(135deg, #ff9a9e, #fad0c4); }
    .sunset { background: linear-gradient(135deg, #ff758c, #ff7eb3); }
    .aqua   { background: linear-gradient(135deg, #13547a, #80d0c7); }
    .mint   { background: linear-gradient(135deg, #d4fc79, #96e6a1); }
    .peach  { background: linear-gradient(135deg, #ffecd2, #fcb69f); }
    .dream  { background: linear-gradient(135deg, #c471f5, #fa71cd); }
    .ice    { background: linear-gradient(135deg, #74ebd5, #9face6); }

    /* Gradient Themes - Row 2 */
    .fire     { background: linear-gradient(135deg, #ff6b35, #f7931e); }
    .ocean    { background: linear-gradient(135deg, #2e3192, #1bffff); }
    .forest   { background: linear-gradient(135deg, #134e5e, #71b280); }
    .gold     { background: linear-gradient(135deg, #f7971e, #ffd200); }
    .purple   { background: linear-gradient(135deg, #667eea, #764ba2); }
    .coral    { background: linear-gradient(135deg, #ff7b7b, #ff416c); }
    .midnight { background: linear-gradient(135deg, #232526, #414345); }
    .autumn   { background: linear-gradient(135deg, #fa709a, #fee140); }
    .lime     { background: linear-gradient(135deg, #a8e6cf, #dcedc1); }
    .lavender { background: linear-gradient(135deg, #d299c2, #fef9d7); }
    .cherry   { background: linear-gradient(135deg, #eb3349, #f45c43); }
    .steel    { background: linear-gradient(135deg, #74b9ff, #0984e3); }

    .signature-text {
      position: absolute;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      font-family: Arial, sans-serif;
      font-size: 18px;
      font-weight: normal;
      pointer-events: none;
      z-index: 100;
      white-space: nowrap;
    }

    .social-info {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.9);
      padding: 8px 16px;
      border-radius: 20px;
      backdrop-filter: blur(8px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .social-info:hover {
      transform: translateX(-50%) translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .made-by {
      font-size: 12px;
      color: #666;
      font-weight: 500;
      white-space: nowrap;
    }

    .social-links {
      display: flex;
      gap: 8px;
    }

    .social-links a {
      font-size: 16px;
      text-decoration: none;
      transition: transform 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
    }

    .social-links a:hover {
      transform: scale(1.2);
    }

    .social-links a svg {
      transition: opacity 0.2s ease;
    }

    .social-links a:hover svg {
      opacity: 0.8;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Canvas Frame with Gradient Background -->
    <div class="canvas-frame" id="canvasFrame">
      <!-- Uploaded Image Preview -->
      <div class="image-container" id="imageContainer" style="display: none; padding: 300px;">
        <img id="previewImage" class="uploaded-image" src="" alt="Uploaded" style="border-radius: 80px; box-shadow: 0 50px 100px rgba(0, 0, 0, 0.4);" />
      </div>
      <!-- Signature Text -->
      <div class="signature-text" id="signatureText" style="display: none;"></div>
    </div>

    <!-- Ratio Selector -->
    <div class="ratio-selector">
      <div class="ratio-btn" onclick="changeRatio('16:9')" data-ratio="16:9">16:9</div>
      <div class="ratio-btn active" onclick="changeRatio('4:3')" data-ratio="4:3">4:3</div>
      <div class="ratio-btn" onclick="changeRatio('3:2')" data-ratio="3:2">3:2</div>
      <div class="ratio-btn" onclick="changeRatio('1:1')" data-ratio="1:1">1:1</div>
      <div class="ratio-btn" onclick="changeRatio('1200:630')" data-ratio="1200:630">1200:630</div>
    </div>

    <!-- Upload Box -->
    <div class="upload-box" id="uploadBox">
      <h3>🎨 Create Amazing Images</h3>
      <p>Drag & drop your image here<br>or click the button below</p>
      <button class="upload-btn" onclick="document.getElementById('fileUpload').click()">
        📁 Choose Image
      </button>
      <input type="file" id="fileUpload" accept="image/*" style="display: none;">
    </div>

    <!-- Theme Selector -->
    <div class="theme-selector">
      <!-- Column 1 -->
      <div class="theme-column">
        <div class="theme cool" onclick="changeTheme('cool')"></div>
        <div class="theme beach" onclick="changeTheme('beach')"></div>
        <div class="theme violet" onclick="changeTheme('violet')"></div>
        <div class="theme rose" onclick="changeTheme('rose')"></div>
        <div class="theme sky" onclick="changeTheme('sky')"></div>
        <div class="theme love" onclick="changeTheme('love')"></div>
        <div class="theme sunset" onclick="changeTheme('sunset')"></div>
        <div class="theme aqua" onclick="changeTheme('aqua')"></div>
        <div class="theme mint" onclick="changeTheme('mint')"></div>
        <div class="theme peach" onclick="changeTheme('peach')"></div>
        <div class="theme dream" onclick="changeTheme('dream')"></div>
        <div class="theme ice" onclick="changeTheme('ice')"></div>
      </div>
      
      <!-- Column 2 -->
      <div class="theme-column">
        <div class="theme fire" onclick="changeTheme('fire')"></div>
        <div class="theme ocean" onclick="changeTheme('ocean')"></div>
        <div class="theme forest" onclick="changeTheme('forest')"></div>
        <div class="theme gold" onclick="changeTheme('gold')"></div>
        <div class="theme purple" onclick="changeTheme('purple')"></div>
        <div class="theme coral" onclick="changeTheme('coral')"></div>
        <div class="theme midnight" onclick="changeTheme('midnight')"></div>
        <div class="theme autumn" onclick="changeTheme('autumn')"></div>
        <div class="theme lime" onclick="changeTheme('lime')"></div>
        <div class="theme lavender" onclick="changeTheme('lavender')"></div>
        <div class="theme cherry" onclick="changeTheme('cherry')"></div>
        <div class="theme steel" onclick="changeTheme('steel')"></div>
      </div>
      
      <!-- Column 3 - Image Themes -->
      <div class="theme-column">
        <div class="image-theme" onclick="changeImageTheme('1')" style="background-image: url('https://cdn.addbackground.app/image/thumb/1.jpg')" data-full-image="https://cdn.addbackground.app/image/1.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('2')" style="background-image: url('https://cdn.addbackground.app/image/thumb/2.jpg')" data-full-image="https://cdn.addbackground.app/image/2.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('3')" style="background-image: url('https://cdn.addbackground.app/image/thumb/3.jpg')" data-full-image="https://cdn.addbackground.app/image/3.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('4')" style="background-image: url('https://cdn.addbackground.app/image/thumb/4.jpg')" data-full-image="https://cdn.addbackground.app/image/4.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('5')" style="background-image: url('https://cdn.addbackground.app/image/thumb/5.jpg')" data-full-image="https://cdn.addbackground.app/image/5.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('6')" style="background-image: url('https://cdn.addbackground.app/image/thumb/6.jpg')" data-full-image="https://cdn.addbackground.app/image/6.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('7')" style="background-image: url('https://cdn.addbackground.app/image/thumb/7.jpg')" data-full-image="https://cdn.addbackground.app/image/7.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('8')" style="background-image: url('https://cdn.addbackground.app/image/thumb/8.jpg')" data-full-image="https://cdn.addbackground.app/image/8.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('9')" style="background-image: url('https://cdn.addbackground.app/image/thumb/9.jpg')" data-full-image="https://cdn.addbackground.app/image/9.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('10')" style="background-image: url('https://cdn.addbackground.app/image/thumb/10.jpg')" data-full-image="https://cdn.addbackground.app/image/10.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('11')" style="background-image: url('https://cdn.addbackground.app/image/thumb/11.jpg')" data-full-image="https://cdn.addbackground.app/image/11.jpg"></div>
        <div class="image-theme" onclick="changeImageTheme('12')" style="background-image: url('https://cdn.addbackground.app/image/thumb/12.jpg')" data-full-image="https://cdn.addbackground.app/image/12.jpg"></div>
      </div>
    </div>

    <!-- Style Controls -->
    <div class="control-panel">
      <label for="rounded">🔵 Rounded 
        <span class="value-display" id="roundedValue">80px</span>
      </label>
      <input type="range" id="rounded" min="0" max="200" value="80">

      <label for="padding">📏 Padding 
        <span class="value-display" id="paddingValue">300px</span>
      </label>
      <input type="range" id="padding" min="0" max="1000" value="300">

      <label for="shadow">🌫️ Shadow 
        <span class="value-display" id="shadowValue">100</span>
      </label>
      <input type="range" id="shadow" min="0" max="300" value="100">

      <label for="signature">✍️ Signature</label>
      <input type="text" id="signature" placeholder="Your text signature..." style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
    </div>

    <!-- Download Box -->
    <div class="download-box">
      <button class="download-btn" id="downloadBtn" onclick="downloadImage()" disabled>
        📥 Download
      </button>
    </div>

    <!-- Social Info -->
    <div class="social-info">
      <span class="made-by">Made by Trung Nguyễn</span>
      <div class="social-links">
        <a href="https://www.facebook.com/trungnx26/" target="_blank" title="Facebook">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="#1877F2">
            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
          </svg>
        </a>
        <a href="https://www.youtube.com/@trungtalks" target="_blank" title="YouTube">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="#FF0000">
            <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
          </svg>
        </a>
        <a href="https://www.hocai.today/" target="_blank" title="Học AI Today">🌐</a>
      </div>
    </div>
  </div>

  <script>
    const themes = {
      // Row 1
      cool: 'linear-gradient(135deg, #a1c4fd, #c2e9fb)',
      beach: 'linear-gradient(135deg, #00c9ff, #92fe9d)',
      violet: 'linear-gradient(135deg, #a18cd1, #fbc2eb)',
      rose: 'linear-gradient(135deg, #fbc2eb, #a6c1ee)',
      sky: 'linear-gradient(135deg, #89f7fe, #66a6ff)',
      love: 'linear-gradient(135deg, #ff9a9e, #fad0c4)',
      sunset: 'linear-gradient(135deg, #ff758c, #ff7eb3)',
      aqua: 'linear-gradient(135deg, #13547a, #80d0c7)',
      mint: 'linear-gradient(135deg, #d4fc79, #96e6a1)',
      peach: 'linear-gradient(135deg, #ffecd2, #fcb69f)',
      dream: 'linear-gradient(135deg, #c471f5, #fa71cd)',
      ice: 'linear-gradient(135deg, #74ebd5, #9face6)',
      
      // Row 2
      fire: 'linear-gradient(135deg, #ff6b35, #f7931e)',
      ocean: 'linear-gradient(135deg, #2e3192, #1bffff)',
      forest: 'linear-gradient(135deg, #134e5e, #71b280)',
      gold: 'linear-gradient(135deg, #f7971e, #ffd200)',
      purple: 'linear-gradient(135deg, #667eea, #764ba2)',
      coral: 'linear-gradient(135deg, #ff7b7b, #ff416c)',
      midnight: 'linear-gradient(135deg, #232526, #414345)',
      autumn: 'linear-gradient(135deg, #fa709a, #fee140)',
      lime: 'linear-gradient(135deg, #a8e6cf, #dcedc1)',
      lavender: 'linear-gradient(135deg, #d299c2, #fef9d7)',
      cherry: 'linear-gradient(135deg, #eb3349, #f45c43)',
      steel: 'linear-gradient(135deg, #74b9ff, #0984e3)'
    };

    const ratios = {
      '16:9': 16/9,
      '4:3': 4/3,
      '3:2': 3/2,
      '1:1': 1/1,
      '1200:630': 1200/630
    };

    let currentRatio = '4:3';
    let currentTheme = 'sky'; // Track current theme
    let currentThemeType = 'gradient'; // 'gradient' or 'image'
    let currentImageTheme = '1'; // Track current image theme
    let originalImageData = null; // Store original image data for high-res downloads
    
    // Performance: Cache for preloaded images
    const imageCache = new Map();
    const preloadedImages = new Set();

    // Performance: Preload full-size image when thumbnail is hovered
    function preloadImage(imageNumber) {
      if (preloadedImages.has(imageNumber)) return;
      
      const fullImageUrl = `https://cdn.addbackground.app/image/${imageNumber}.jpg`;
      const img = new Image();
      img.onload = () => {
        imageCache.set(imageNumber, img);
        preloadedImages.add(imageNumber);
        console.log(`Preloaded image ${imageNumber}`);
      };
      img.src = fullImageUrl;
    }

    // Add hover events to preload full images
    document.addEventListener('DOMContentLoaded', function() {
      const imageThemes = document.querySelectorAll('.image-theme');
      imageThemes.forEach((theme, index) => {
        const imageNumber = (index + 1).toString();
        theme.addEventListener('mouseenter', () => preloadImage(imageNumber));
      });
    });

    function changeTheme(theme) {
      currentTheme = theme;
      currentThemeType = 'gradient';
      const frame = document.getElementById('canvasFrame');
      
      // Clear all background image properties first
      frame.style.backgroundImage = 'none';
      frame.style.backgroundSize = '';
      frame.style.backgroundPosition = '';
      frame.style.backgroundRepeat = '';
      
      // Set the gradient background
      frame.style.background = themes[theme];
    }

    function changeImageTheme(imageNumber) {
      currentImageTheme = imageNumber;
      currentThemeType = 'image';
      const frame = document.getElementById('canvasFrame');
      
      // Clear gradient background first
      frame.style.background = 'transparent';
      
      // Use full-size image only when actually selected as background
      frame.style.backgroundImage = `url('https://cdn.addbackground.app/image/${imageNumber}.jpg')`;
      frame.style.backgroundSize = 'cover';
      frame.style.backgroundPosition = 'center';
      frame.style.backgroundRepeat = 'no-repeat';
    }

    function changeRatio(ratio) {
      currentRatio = ratio;
      
      // Update active button
      document.querySelectorAll('.ratio-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      document.querySelector(`[data-ratio="${ratio}"]`).classList.add('active');
      
      if (originalImageData) {
        // Image uploaded - ratio controls background, image fits within
        updateImageSize();
      } else {
        // No image uploaded - ratio controls frame size directly
        const frame = document.getElementById('canvasFrame');
        const containerWidth = window.innerWidth - 280; // Account for control panels
        const containerHeight = window.innerHeight - 120; // Account for top/bottom spacing
        
        const aspectRatio = ratios[ratio];
        let width, height;
        
        // Calculate optimal size while maintaining aspect ratio
        if (containerWidth / containerHeight > aspectRatio) {
          // Height is the limiting factor
          height = Math.min(containerHeight, 600);
          width = height * aspectRatio;
        } else {
          // Width is the limiting factor
          width = Math.min(containerWidth, 800);
          height = width / aspectRatio;
        }
        
        frame.style.width = width + 'px';
        frame.style.height = height + 'px';
      }
    }

    // Initialize with default theme and ratio
    changeTheme('sky');
    changeRatio('4:3');
    
    // Initialize padding value display
    document.getElementById('paddingValue').textContent = '300px';

    // File upload handling
    document.getElementById('fileUpload').addEventListener('change', function(event) {
      const file = event.target.files[0];
      if (file) {
        handleImageFile(file);
      }
    });

    // Function to handle image file (used by both upload and drag/drop)
    function handleImageFile(file) {
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const previewImg = document.getElementById('previewImage');
          previewImg.src = e.target.result;
          
          // Store original image data for high-res downloads
          previewImg.onload = function() {
            originalImageData = {
              src: e.target.result,
              naturalWidth: previewImg.naturalWidth,
              naturalHeight: previewImg.naturalHeight
            };
            console.log('Original image size:', originalImageData.naturalWidth, 'x', originalImageData.naturalHeight);
            
            // Apply initial padding and sizing immediately
            updateImageSize();
          };
          
          document.getElementById('imageContainer').style.display = 'block';
          document.getElementById('downloadBtn').disabled = false;
          
          // Hide upload box when image is loaded
          document.getElementById('uploadBox').style.display = 'none';
          
          // Set image size based on current canvas frame
          updateImageSize();
        };
        reader.readAsDataURL(file);
      }
    }

    // Drag and Drop functionality
    const canvasFrame = document.getElementById('canvasFrame');
    const uploadBox = document.getElementById('uploadBox');

    // Add drag events to both canvas and upload box
    function addDragEvents(element) {
      element.addEventListener('dragover', function(e) {
        e.preventDefault();
        e.stopPropagation();
        canvasFrame.classList.add('drag-over');
        uploadBox.classList.add('drag-over');
      });

      element.addEventListener('dragenter', function(e) {
        e.preventDefault();
        e.stopPropagation();
        canvasFrame.classList.add('drag-over');
        uploadBox.classList.add('drag-over');
      });

      element.addEventListener('dragleave', function(e) {
        e.preventDefault();
        e.stopPropagation();
        // Only remove if we're actually leaving the canvas area
        if (!canvasFrame.contains(e.relatedTarget)) {
          canvasFrame.classList.remove('drag-over');
          uploadBox.classList.remove('drag-over');
        }
      });

      element.addEventListener('drop', function(e) {
        e.preventDefault();
        e.stopPropagation();
        canvasFrame.classList.remove('drag-over');
        uploadBox.classList.remove('drag-over');
        
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          handleImageFile(files[0]);
        }
      });
    }

    // Apply drag events to both elements
    addDragEvents(canvasFrame);
    addDragEvents(uploadBox);

    // Function to update frame size based on ratio and image positioning
    function updateImageSize() {
      const frame = document.getElementById('canvasFrame');
      const img = document.getElementById('previewImage');
      const paddingValue = parseInt(document.getElementById('padding').value);
      
      if (!originalImageData) {
        // No image uploaded - use ratio for frame size (existing behavior)
        return;
      }
      
      // Calculate display scale for the image (keep it reasonably sized for screen)
      const maxDisplaySize = 560; // Maximum image display size (1.4x bigger)
      const imageAspectRatio = originalImageData.naturalWidth / originalImageData.naturalHeight;
      let displayImageWidth, displayImageHeight;
      
      if (originalImageData.naturalWidth > originalImageData.naturalHeight) {
        displayImageWidth = Math.min(maxDisplaySize, originalImageData.naturalWidth);
        displayImageHeight = displayImageWidth / imageAspectRatio;
      } else {
        displayImageHeight = Math.min(maxDisplaySize, originalImageData.naturalHeight);
        displayImageWidth = displayImageHeight * imageAspectRatio;
      }
      
      // Calculate the scale factor between original and display image
      const imageScale = displayImageWidth / originalImageData.naturalWidth;
      
      // Scale padding proportionally to maintain visual relationship
      const scaledPaddingValue = paddingValue * imageScale;
      
      // Calculate minimum frame size needed (image + scaled padding)
      const minFrameWidth = displayImageWidth + (scaledPaddingValue * 2);
      const minFrameHeight = displayImageHeight + (scaledPaddingValue * 2);
      
      // Calculate frame size based on ratio, ensuring it fits the image + padding
      const aspectRatio = ratios[currentRatio];
      let frameWidth, frameHeight;
      
      if (minFrameWidth / minFrameHeight > aspectRatio) {
        // Width is the limiting factor
        frameWidth = minFrameWidth;
        frameHeight = frameWidth / aspectRatio;
      } else {
        // Height is the limiting factor
        frameHeight = minFrameHeight;
        frameWidth = frameHeight * aspectRatio;
      }
      
      // Scale down if too big for screen
      const containerWidth = window.innerWidth - 280;
      const containerHeight = window.innerHeight - 120;
      const scaleX = containerWidth / frameWidth;
      const scaleY = containerHeight / frameHeight;
      const scale = Math.min(scaleX, scaleY, 1);
      
      frameWidth *= scale;
      frameHeight *= scale;
      displayImageWidth *= scale;
      displayImageHeight *= scale;
      const finalScaledPadding = scaledPaddingValue * scale;
      
      // Set frame size
      frame.style.width = frameWidth + 'px';
      frame.style.height = frameHeight + 'px';
      
      // Set image size (fixed size, not affected by padding)
      img.style.width = displayImageWidth + 'px';
      img.style.height = displayImageHeight + 'px';
      img.style.maxWidth = 'none';
      img.style.maxHeight = 'none';
      
      // Remove padding from container - image will be centered by CSS
      document.getElementById('imageContainer').style.padding = '0px';
      
      // Update scaled rounded corners and shadow to match new image size
      const roundedValue = parseInt(document.getElementById('rounded').value);
      const shadowValue = parseInt(document.getElementById('shadow').value);
      const newScale = displayImageWidth / originalImageData.naturalWidth;
      
      const scaledRounded = roundedValue * newScale;
      const scaledShadow = shadowValue * newScale;
      
      img.style.borderRadius = scaledRounded + 'px';
      img.style.boxShadow = `0 ${scaledShadow / 2}px ${scaledShadow}px rgba(0, 0, 0, 0.4)`;
      
      console.log('Preview: Frame', frameWidth + 'x' + frameHeight, '(' + currentRatio + ')', 'Image', displayImageWidth + 'x' + displayImageHeight, 'Original padding', paddingValue, 'Scaled padding', finalScaledPadding.toFixed(1));
    }

    // Live style controls with value display
    const preview = document.getElementById('previewImage');
    const container = document.getElementById('imageContainer');

    document.getElementById('rounded').addEventListener('input', function() {
      const roundedValue = parseInt(this.value);
      
      // Scale rounded corners proportionally for preview
      if (originalImageData) {
        const previewImg = document.getElementById('previewImage');
        const currentImgWidth = parseFloat(previewImg.style.width) || previewImg.offsetWidth;
        const scale = currentImgWidth / originalImageData.naturalWidth;
        const scaledRounded = roundedValue * scale;
        preview.style.borderRadius = scaledRounded + 'px';
      } else {
        preview.style.borderRadius = roundedValue + 'px';
      }
      
      document.getElementById('roundedValue').textContent = roundedValue + 'px';
    });

    document.getElementById('padding').addEventListener('input', function() {
      document.getElementById('paddingValue').textContent = this.value + 'px';
      if (originalImageData) {
        updateImageSize(); // Update frame and image size based on new padding
      }
    });

    document.getElementById('shadow').addEventListener('input', function() {
      const shadowValue = parseInt(this.value);
      
      // Scale shadow proportionally for preview
      if (originalImageData) {
        const previewImg = document.getElementById('previewImage');
        const currentImgWidth = parseFloat(previewImg.style.width) || previewImg.offsetWidth;
        const scale = currentImgWidth / originalImageData.naturalWidth;
        const scaledShadow = shadowValue * scale;
        preview.style.boxShadow = `0 ${scaledShadow / 2}px ${scaledShadow}px rgba(0, 0, 0, 0.4)`;
      } else {
        preview.style.boxShadow = `0 ${shadowValue / 2}px ${shadowValue}px rgba(0, 0, 0, 0.4)`;
      }
      
      document.getElementById('shadowValue').textContent = shadowValue;
    });

    document.getElementById('signature').addEventListener('input', function() {
      const signatureText = document.getElementById('signatureText');
      const text = this.value.trim();
      
      console.log('Signature input:', text); // Debug log
      
      if (text) {
        signatureText.textContent = text;
        signatureText.style.display = 'block';
        signatureText.style.visibility = 'visible';
      } else {
        signatureText.style.display = 'none';
        signatureText.style.visibility = 'hidden';
      }
    });

    // Download functionality
    function downloadImage() {
      const frame = document.getElementById('canvasFrame');
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      
      let canvasWidth, canvasHeight;
      
      // If there's an uploaded image, base canvas size on ratio and ensure image fits
      if (originalImageData) {
        const paddingValue = parseInt(document.getElementById('padding').value);
        const aspectRatio = ratios[currentRatio];
        
        // Calculate minimum canvas size needed for image + padding
        const minCanvasWidth = originalImageData.naturalWidth + (paddingValue * 2);
        const minCanvasHeight = originalImageData.naturalHeight + (paddingValue * 2);
        
        // Calculate canvas size based on ratio, ensuring it's big enough for the image
        if (minCanvasWidth / minCanvasHeight > aspectRatio) {
          // Width is the limiting factor
          canvasWidth = minCanvasWidth;
          canvasHeight = canvasWidth / aspectRatio;
        } else {
          // Height is the limiting factor
          canvasHeight = minCanvasHeight;
          canvasWidth = canvasHeight * aspectRatio;
        }
        
        console.log('Canvas size based on ratio', currentRatio + ':', canvasWidth, 'x', canvasHeight);
      } else {
        // No image uploaded, use frame size as fallback
        const frameRect = frame.getBoundingClientRect();
        canvasWidth = frameRect.width * 4;
        canvasHeight = frameRect.height * 4;
        console.log('Fixed canvas size (no image):', canvasWidth, 'x', canvasHeight);
      }
      
      canvas.width = canvasWidth;
      canvas.height = canvasHeight;
      
      // No scaling needed since we're working in actual pixel dimensions
      
      // Handle background based on theme type
      if (currentThemeType === 'gradient') {
        // Get current theme and create proper gradient
        const gradient = createCanvasGradient(ctx, currentTheme, canvasWidth, canvasHeight);
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvasWidth, canvasHeight);
        
        // Continue with image drawing
        drawImageAndSignature(ctx, canvasWidth, canvasHeight, canvas);
            } else if (currentThemeType === 'image') {
        // Load CDN background image for download using fetch to bypass CORS
        let imageLoaded = false;
        
        // Function to handle fallback
        const useFallback = function(reason) {
          if (imageLoaded) return; // Prevent multiple executions
          imageLoaded = true;
          console.log('Using fallback background, reason:', reason);
          
          const fallbackColors = [
            '#667eea', '#f093fb', '#4facfe', '#43e97b', '#fa709a', 
            '#ffecd2', '#a8edea', '#d299c2', '#89f7fe', '#667eea',
            '#f093fb', '#4facfe'
          ];
          const colorIndex = (parseInt(currentImageTheme) - 1) % fallbackColors.length;
          const gradient = ctx.createLinearGradient(0, 0, canvasWidth, canvasHeight);
          gradient.addColorStop(0, fallbackColors[colorIndex]);
          gradient.addColorStop(1, fallbackColors[(colorIndex + 1) % fallbackColors.length]);
          ctx.fillStyle = gradient;
          ctx.fillRect(0, 0, canvasWidth, canvasHeight);
          drawImageAndSignature(ctx, canvasWidth, canvasHeight, canvas);
        };
        
        // Try multiple approaches to load the image
        const baseImageUrl = `https://cdn.addbackground.app/image/${currentImageTheme}.jpg`;
        console.log('Loading background image:', baseImageUrl);
        
        // Method 1: Try direct loading with CORS (might work if server is configured properly)
        const tryDirectLoad = () => {
          const bgImage = new Image();
          bgImage.crossOrigin = 'anonymous';
          
          bgImage.onload = function() {
            if (imageLoaded) return;
            imageLoaded = true;
            console.log('Background image loaded successfully (direct method)');
            console.log('Image dimensions:', bgImage.naturalWidth, 'x', bgImage.naturalHeight);
            ctx.drawImage(bgImage, 0, 0, canvasWidth, canvasHeight);
            drawImageAndSignature(ctx, canvasWidth, canvasHeight, canvas);
          };
          
          bgImage.onerror = function() {
            console.log('Direct loading failed, trying proxy method...');
            tryProxyLoad();
          };
          
          bgImage.src = baseImageUrl;
        };
        
                 // Method 2: Try using a CORS proxy
        const tryProxyLoad = () => {
          const proxyUrl = `https://cors-anywhere.herokuapp.com/${baseImageUrl}`;
          
          fetch(proxyUrl, {
            method: 'GET',
            headers: {
              'X-Requested-With': 'XMLHttpRequest'
            }
          })
          .then(response => {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.blob();
          })
          .then(blob => {
            // Create object URL from blob
            const blobUrl = URL.createObjectURL(blob);
            const bgImage = new Image();
            
            bgImage.onload = function() {
              if (imageLoaded) return;
              imageLoaded = true;
              console.log('Background image loaded successfully via proxy');
              console.log('Image dimensions:', bgImage.naturalWidth, 'x', bgImage.naturalHeight);
              
              // Draw background image to cover the entire canvas
              ctx.drawImage(bgImage, 0, 0, canvasWidth, canvasHeight);
              drawImageAndSignature(ctx, canvasWidth, canvasHeight, canvas);
              
              // Clean up the blob URL
              URL.revokeObjectURL(blobUrl);
            };
            
            bgImage.onerror = function(e) {
              console.error('Proxy image failed to load:', e);
              URL.revokeObjectURL(blobUrl);
              useFallback('Proxy image error');
            };
            
            bgImage.src = blobUrl;
          })
          .catch(error => {
            console.error('Proxy fetch failed:', error);
            useFallback('Proxy fetch error: ' + error.message);
          });
        };
        
        // Start with direct loading
        tryDirectLoad();
        
        // Set timeout for the entire process
        setTimeout(() => {
          if (!imageLoaded) {
            console.warn('Image loading timeout after 15 seconds');
            useFallback('Timeout');
          }
        }, 15000);
        
        return;
      }
    }
    
    function drawImageAndSignature(ctx, canvasWidth, canvasHeight, canvas) {
      // Draw image if exists
      const img = document.getElementById('previewImage');
      if (img.src && img.offsetWidth > 0 && originalImageData) {
        const paddingValue = parseInt(document.getElementById('padding').value);
        
        // Use original image dimensions at full size
        const finalWidth = originalImageData.naturalWidth;
        const finalHeight = originalImageData.naturalHeight;
        
        // Center the image in the canvas - this ensures even padding/background distribution
        const x = (canvasWidth - finalWidth) / 2;
        const y = (canvasHeight - finalHeight) / 2;
        
        console.log('Image positioning: Canvas', canvasWidth + 'x' + canvasHeight, 'Image at (' + x + ',' + y + ')', finalWidth + 'x' + finalHeight);
        
        // Create image element for canvas using original high-res data
        const image = new Image();
        image.crossOrigin = 'anonymous'; // Fix CORS for uploaded images if needed
        image.onload = function() {
          const shadowValue = parseInt(document.getElementById('shadow').value);
          const rounded = parseInt(document.getElementById('rounded').value);
          
          // Draw shadow first if needed (before clipping)
          if (shadowValue > 0) {
            ctx.save();
            ctx.shadowColor = 'rgba(0, 0, 0, 0.4)';
            ctx.shadowBlur = shadowValue;
            ctx.shadowOffsetX = shadowValue / 2;
            ctx.shadowOffsetY = shadowValue / 2;
            
            // Create a temporary canvas to draw the image with rounded corners
            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            tempCanvas.width = finalWidth;
            tempCanvas.height = finalHeight;
            
            // Draw original high-res image to temp canvas with rounded corners
            if (rounded > 0) {
              tempCtx.beginPath();
              tempCtx.roundRect(0, 0, finalWidth, finalHeight, rounded);
              tempCtx.clip();
            }
            tempCtx.drawImage(image, 0, 0, finalWidth, finalHeight);
            
            // Draw the temp canvas with shadow to main canvas
            ctx.drawImage(tempCanvas, x, y);
            ctx.restore();
          } else {
            // No shadow, just draw normally with clipping
            ctx.save();
            if (rounded > 0) {
              ctx.beginPath();
              ctx.roundRect(x, y, finalWidth, finalHeight, rounded);
              ctx.clip();
            }
            ctx.drawImage(image, x, y, finalWidth, finalHeight);
            ctx.restore();
          }
          
          // Add signature text if exists
          addSignatureToCanvas(ctx, canvasWidth, canvasHeight);
          
          // Download
          downloadCanvas(canvas, currentThemeType);
        };
        image.src = originalImageData.src; // Use original high-res image data
      } else {
        // No image, just download background with signature if exists
        addSignatureToCanvas(ctx, canvasWidth, canvasHeight);
        downloadCanvas(canvas, currentThemeType);
      }
    }
    
    function addSignatureToCanvas(ctx, canvasWidth, canvasHeight) {
      const signatureInput = document.getElementById('signature');
      if (signatureInput.value.trim()) {
        // Calculate font size proportional to canvas size
        // Base: 18px for ~800px width canvas (like preview)
        const baseFontSize = 18;
        const baseCanvasWidth = 800;
        const scaledFontSize = Math.max(12, (canvasWidth / baseCanvasWidth) * baseFontSize);
        const scaledMargin = Math.max(10, (canvasWidth / baseCanvasWidth) * 20);
        
        ctx.fillStyle = 'white';
        ctx.font = `${scaledFontSize}px Arial, sans-serif`;
        ctx.textAlign = 'center';
        
        const textX = canvasWidth / 2;
        const textY = canvasHeight - scaledMargin;
        ctx.fillText(signatureInput.value.trim(), textX, textY);
        
        console.log('Signature: Font size', scaledFontSize.toFixed(1) + 'px', 'Margin', scaledMargin.toFixed(1) + 'px');
      }
    }
    
    function downloadCanvas(canvas, themeType) {
      const link = document.createElement('a');
      const prefix = themeType === 'image' ? 'image-background' : 'gradient-background';
      link.download = `${prefix}-${currentRatio.replace(':', 'x')}.png`;
      link.href = canvas.toDataURL();
      link.click();
    }
    

    
    function createCanvasGradient(ctx, themeName, width, height) {
      // Define color pairs for each theme
      const gradients = {
        // Row 1
        cool: ['#a1c4fd', '#c2e9fb'],
        beach: ['#00c9ff', '#92fe9d'],
        violet: ['#a18cd1', '#fbc2eb'],
        rose: ['#fbc2eb', '#a6c1ee'],
        sky: ['#89f7fe', '#66a6ff'],
        love: ['#ff9a9e', '#fad0c4'],
        sunset: ['#ff758c', '#ff7eb3'],
        aqua: ['#13547a', '#80d0c7'],
        mint: ['#d4fc79', '#96e6a1'],
        peach: ['#ffecd2', '#fcb69f'],
        dream: ['#c471f5', '#fa71cd'],
        ice: ['#74ebd5', '#9face6'],
        
        // Row 2
        fire: ['#ff6b35', '#f7931e'],
        ocean: ['#2e3192', '#1bffff'],
        forest: ['#134e5e', '#71b280'],
        gold: ['#f7971e', '#ffd200'],
        purple: ['#667eea', '#764ba2'],
        coral: ['#ff7b7b', '#ff416c'],
        midnight: ['#232526', '#414345'],
        autumn: ['#fa709a', '#fee140'],
        lime: ['#a8e6cf', '#dcedc1'],
        lavender: ['#d299c2', '#fef9d7'],
        cherry: ['#eb3349', '#f45c43'],
        steel: ['#74b9ff', '#0984e3']
      };
      
      const colors = gradients[themeName] || gradients.sky;
      const gradient = ctx.createLinearGradient(0, 0, width, height);
      gradient.addColorStop(0, colors[0]);
      gradient.addColorStop(1, colors[1]);
      
      return gradient;
    }

    // Handle window resize
    window.addEventListener('resize', function() {
      changeRatio(currentRatio);
      updateImageSize();
    });
  </script>
</body>
</html>